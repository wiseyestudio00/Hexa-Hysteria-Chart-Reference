# Table of contents

- [基本規則](#基本規則)
- [音符](#音符)
  - [音符種類](#音符種類)
  - [軌道](#軌道)
  - [格式](#格式)
  - [連續輸入：](#連續輸入)
- [舞台行動](#舞台行動)
  - [模式算式](#模式算式)
  - [攝影機](#攝影機)
  - [更換顏色](#更換顏色)
  - [更換文字](#更換文字)
  - [重組舞台](#重組舞台)
- [註釋](#註釋)
- [尚未寫出的舞台行動](#尚未寫出的舞台行動)
  - [顯示圖片](#顯示圖片)

# 基本規則
1. 所有的時間單位都是`拍子`
2. 音符跟行動可以不照拍子排列，**但我還是建議盡量照順序排，以免混淆**
3. **大小寫沒有區別，大小寫沒有區別，大小寫沒有區別**
4. 不要在同一時間內使用相同的行動

# 音符
最基本的舞台構成。

## 音符種類
類型 | 譜面使用
------------ | -------------
短 | short
滑動 | swipe
長 | long
連打 | compound

## 軌道
類型 | 譜面使用
------------ | -------------
左上 | lt (left top)
左中 | lc (left center)
左下 | lb (left bottom)
右上 | rt (right top)
右中 | rc (right center)
右下 | rb (right bottom)

## 格式
### 短
打擊點到的時候，需要**點擊**的音符
```
n short rc 0
```
打擊點在第零拍，在右中的短音符
### 滑動
打擊點到的時候，需要**滑動**的音符
```
n swipe in rt 0
```
打擊點在第零拍，在右上的向內滑動音符
```
n swipe out rc 10
```
打擊點在第十拍，在右中的向外滑動音符
### 連續
打擊點到的時候，**不需要點擊，只需要有按著軌道** 的音符
```
n catch rc 0
```
打擊點在第零拍，在右中的連續音符
### 長
打擊點到的時候，需要 **點擊，並且按住軌道直到結束** 的音符
```
n long lb 0 10
```
打擊在第零拍開始，在第十拍結束，在左下的長音符
### 連打
打擊點開始到結束時，需要**點擊至少特定次數**的音符
```
n compound lc 0 10 12
```
打擊在第零拍開始，第十拍結束，需要打12次的連打音符

## 連續輸入：
你可以同時輸入很多軌道
```
n short rt rc rb 0
```
在右上，右中，右下的第零拍短音符

這樣跟
```
n short rt 0
n short rc 0
n short rb 0
```
的效果一樣，只是可以少三行

# 舞台行動
現在我有譜面了，但是，只有音符的話，舞台看起來死氣沈沈的。沒有其他指令可以輸入了嗎？

別擔心，你還有`舞台行動`！

舞台行動是給舞台的指示，像是更改字體顏色，旋轉舞台之類的行動。

雖然舞台行動才是譜面的精髓所在⋯⋯
但是！使用它前請務必**仔細地**讀過下面的文字，才不會發生`寫了超過三個小時都做不出自己想要的效果，結果發現根本已經有內建的功能了`的慘劇。

## 模式算式
在開始講述`舞台行動`之前，必須先說一下`模式算式`。

模式算式是非常重要的概念，在使用舞台行動前，請務必讀這一段文字。

`模式算式`指的是`達成目標的速度以及加速度的變化`。

聽起來很複雜嗎？其實就是類似 `y=x^2` 跟 `y=x`的差別。`y=x^2`上升的速度比較快，但是在`x=1`的時候，`y都等於1`，對吧？

在許多舞台行動中，有很多需要你主動輸入`模式算式`，來讓舞台知道該用什麼`速度及加速度`來完成你需要的行動。

（主要是`有關時間變化的行動`，例如`移動攝影機`，`更換顏色`等等）

例如：

easeinoutsine指的就是`慢->快->慢`

linear是`平均`

為什麼需要使用`模式算式`？_因為使用它可以為譜面帶來生命力還有精緻感_

如果只使用linear的話，整個譜面會看起來死氣沈沈

實際上很難用言語形容。詳細的畫面可以看看[3. 範例譜面](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/%E7%B9%81%E9%AB%94%E4%B8%AD%E6%96%87/3.%E7%AF%84%E4%BE%8B%E8%AD%9C%E9%9D%A2.txt)裡的效果，應該就會明白我的意思了


### 遊戲內建的模式算式列表
```
linear
clerp
spring
easeInQuad
easeOutQuad
easeInOutQuad
easeInCubic
easeOutCubic
easeInOutCubic
easeInQuart
easeOutQuart
easeInOutQuart
easeInQuint
easeOutQuint
easeInOutQuint
easeInSine
easeOutSine
easeInOutSine
easeInExpo
easeOutExpo
easeInOutExpo
easeInCirc
easeOutCirc
easeInOutCirc
easeInBounce
easeOutBounce
easeInOutBounce
easeOutBack
easeInOutBack
easeInElastic
easeOutElastic
easeInOutElastic
```

> 關於這些模式的實際效果，請參考：https://easings.net/

**如果沒辦法決定的話，easeinsine，easeoutsine，easeinoutsine永遠是你的朋友**

## 攝影機
### 旋轉攝影機
旋轉攝影機的角度其實就是旋轉舞台，不過在玩家看來是一模一樣的
#### 格式
```
a changecamera angle 開始拍 持續拍 x角度 y角度 z角度 模式算式
```
#### 示範
```
a changecamera angle 10 2 0 0 60 easeinoutsine
```
在第十拍開始，花兩拍，向z方向旋轉60度，使用easeinoutsine
```
a changecamera angle 0 10 0 0 360 linear
```
在第零拍開始，花十拍，轉360度（一圈），使用linear

#### 詳細解說
雖然三個方位通通都可以旋轉，但是**最有用的是z方位的角度**

從z旋轉的話，效果基本跟Lanota的旋轉差不多

從x跟y旋轉會很奇怪，因為跟Lanota不同，我們的舞台其實是3D的，旋轉的話會變成這樣：
![Move x](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/pics/2.Reference/Rotatex.png)
向x旋轉30度後的結果
![Move y](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/pics/2.Reference/Rotatey.png)
向Y旋轉30度後的結果

雖然比例跑掉了，但舞台會照常運行喔，音符仍然可以被打到。

因此如果你真的心中有使用旋轉x y軸的想法，那還是可以使用。

但是我很不建議：如果你想朝x, y軸旋轉的話，應該要去使用「移動舞台」行動

最後，輸入的角度是`相對位置`，不是`絕對位置`

意思是：

現在舞台是`0 0 30`，輸入`0 0 60`，最後的結果會是`0 0 90`

**如果輸入的持續拍是0的話，會瞬間移動到結束位置**

### 移動攝影機
跟旋轉攝影機一樣，改變的是舞台的大小，但移動的其實是攝影機的位置

#### 格式
```
a changecamera position 開始拍 持續拍 x位置 y位置 z位置 模式算式
```
#### 示範
```
a changecamera position 10 2 0 0 3 easeinoutsine
```
在第十拍，用兩拍的時間，向z方向移動三單位，使用easeinoutsine

#### 解說
跟旋轉舞台一樣，使用的是相對位置

例：
在`0 0 5`的舞台，輸入`0 0 3`後，會到`0 0 8`

跟旋轉舞台一樣，**移動Z是最有效的**。_變的是舞台大小，Z正數是往前（舞台變大），Z負數是往後（舞台變小）_

改變X跟Y會很奇怪
![Move x](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/pics/2.Reference/Movex.png)
^向X移動三單位後的結果
![Move y](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/pics/2.Reference/Movey.png)
^向Y移動三單位後的結果

## 更換顏色
你可以更換畫面上的字體跟音符的顏色

### 格式
```
a changecolor 種類 開始拍 持續拍 新顏色 物件列表 模式算式
```

### 種類
#### Text - 文字
物件種類 | 物件列表名稱
------------ | -------------
分數 | Score
準確率 | Accuracy
歌名 | SongName
譜面名	| ChartName
作曲者 | Composer
連級數 | Combo

#### UIBackground - 上方的背景
物件種類 | 物件列表名稱
------------ | -------------
左上的背景 | lt
右上的背景 | rt

#### Note - 音符
物件種類 | 物件列表名稱
------------ | -------------
短音符 | short
長音符 | long
連打 | compound
滑動 | swipe
連續 | catch

#### Trial - 軌道
物件種類 | 物件列表名稱
------------ | -------------
左上 | lt
左中 | lc
左下 | lb
右上 | rt
右中 | rc
右下 | rb

#### Trial_Pattern - 軌道上緩緩移動的六角形
跟軌道的物件一樣（rt, lc, lb, rt, rc, rb）

#### Hitbox_default - 打擊器，沒有被按住的顏色
跟軌道的物件一樣（rt, lc, lb, rt, rc, rb）

#### HitBox_pressed - 打擊器，被按住時的眼色
跟軌道的物件一樣（rt, lc, lb, rt, rc, rb）

### 顏色格式
`R_G_B_A（紅_綠_藍_透明度）`

每個元素中間要有底線

每項元素的底是0，滿是256

#### 例
`256_256_256_256	> 全白`

`0_0_0_0		> 透明的黑`

### 示範
```
a changecolor text 10 2 256_256_256_125 score accuracy easeinoutsine
```
在第十拍時，花兩拍，讓「分數，準確率」變成半透明的白色，使用easinoutsine

### 解說
關於RGBA，請參考：https://www.colorspire.com/rgb-color-wheel/
（裡面的A=1的時候，是我們A=256的時候）

## 更換文字
可以更換畫面上字的內容，但是連打次數，分數，準確率不能換（換了也沒有道理）

### 換譜面名稱
#### 格式
```
a ChangeText chartname 開始拍 所需拍 新文字 使用隨機字串
```
#####  示範
```
a changeText chartname 10 1 Extreme true
```
在第十拍時，花一拍，把譜面的名字變成extreme，在途中用隨機文字

### 換歌名
#### 格式
```
a ChangeText SongName 開始拍 所需拍 新文字 使用隨機字
```
#### 示範
```
a ChangeText SongName 10 1 A@Cat's@Song true
```
在第十拍時，花一拍的時間，把歌名換成 A Cat’s Song，使用隨機文字

### 換作曲家
#### 格式
```
a ChangeText Composer 開始拍 所需拍 新文字 使用隨機字串
```
#### 示範
```
a ChangeText Composer 10 1 Etika true
```
在第十拍時，花一拍的時間，把作曲家換成etika，使用隨機文字

### 說明
如果不使用隨機文字，字在途中就不會變

例：
`a changetext composer 10 1 false`

`a changetext composer 11 0 false`

效果一模一樣

隨機文字會是亂碼（像`(+_(d3@!?><`之類的），實際效果請自己試試看

**如果想要更換的文字內有空格，請用@取代**，否則會有錯誤

`Hello World -> Hellow@World`

`I love you -> I@love@you`


## 重組舞台
你可以改變舞台的形狀。
這並不是指旋轉或是改變大小，而是真的改變舞台的構成。

正方形舞台
![Square](https://github.com/wiseyestudio00/Hexa-Hysteria-Chart-Reference/blob/main/pics/2.Reference/Rotatey.png)

### 格式
```
a changestage 新舞台名稱 開始拍 持續拍 算式模式
```

[預設的舞台名稱列表](https://docs.google.com/document/d/1qoytsVbdQ8EUK1CnRc-Ril_KJwVlg2gzXNWUGEFYj_g/edit?usp=sharing)

### 示範
```
a changestage square 10 3 easeinoutsine
```
將舞台轉換成sqauare形狀，開始於第十拍，持續三拍完成動作，使用easeinoutsine

### 解說
#### 1. 為什麼旋轉舞台時不也直接用重組舞台行動就好了？為什麼要轉攝影機？
重組舞台是非常跳脫框架的行動。
事實上，我對於這個行動稍稍地感到不安，因為他打破了「六角形」的這個基本規則。

我不希望這是一個經常被使用的行動。他只能被使用在非常特殊的譜面中。

反之，我希望譜師是在有著100%的自信，明確地知道自己正在做什麼的情況下，才使用這個行動

擺弄攝影機，雖然也是比較特殊的行動，但他並沒有打破任何的基本規則。
如果只是想用放大/縮小，旋轉舞台等等的效果，請盡量使用旋轉攝影機。

#### 2. 重組舞台時，可以保證所有的螢幕都能看到軌道嗎？（也就是說，平板或是手機都能看到同樣的效果？）
可以。**平板跟手機看到的舞台是一樣的**

#### 3. 重組的途中，可以正常打擊嗎？
理論上可以。但是有沒有辦法做到手感良好的打擊則需要譜師的技巧了


不在鏡頭內的舞台，並不是消失了，只是在鏡頭外而已

**如果攝影機轉到奇怪的角度，還是有可能看到**

如果真的不想被看到，請搭配 `舞台換色` 行動做使用（將不想要被看到的舞台變透明）

# 註釋
有時候，你可能會希望一些字可以被忽視掉。

```
比如說，當你想要寫註釋的時候：
# 進副歌 <-這個
n short rc 150
```

```
# 三個鼓拍 <-這個
n swipe out rc 151
n swipe in rc 152
n swipe out rc 153
```

⋯⋯等等情況
好消息是，`只要你的開頭不是n或是a的行數，都不會被讀進譜面。他們可以當作註釋使用`

```
例如：
n short rc 150
這句話就是註釋，對譜面沒有影響
n short rc 151
```

還有些時候，你可能會希望能暫時忽略掉很多的行數⋯⋯

那麼，你可以用`/*`跟`*/`

在`/*`之下的行數，直到`*/`之前，都不會被讀進譜面中。

```
例如：
/*
n short rc 0	這些音符
n long rc 0 3	通通
n short rc 3	不會被讀進去
*/

//但是，下面這句會被讀進譜面
n short rc 4
```

還有一點，無字的行數也不會被讀進去

```
例如：
//下面這一行會被讀進去
n short rc 0




//雖然上面空了很多行，但是下面這個音符還是會被讀進去
n short rc 1
```

### 禁止的案例
```
n short rc 0 //這是第一拍（註釋不能跟行動還有音符在同一行）
 n short rc 1（不能用空白當作註釋的開頭）
```

# 尚未寫出的舞台行動
以下是還沒寫出來，預計要植入的舞台行動

# 加拍子
```
a addbeat note/action 99 1 100-104 3 easeinoutsine
```
在第99拍的時候，花一拍的時間，把在開始拍在第100到104拍之間的**音符/舞台行動**的**開始拍** +3 拍

這是一個強大而且複雜的舞台行動，請聽我慢慢解釋。

只要正確使用這個效果，就能製造出**倒退**，**瞬移**，**暫停**，或是幾乎任何跟**時間相關的效果**。

要使用這個效果前，我們得先知道音符與舞台行動的運作方式。

首先，先看看**音符**的位置的計算方式。

音符**出現的時機**，則跟玩家的**音符速度設定**有關。
音符會在他的**開始拍**抵達的時候，跟**打擊器**的位置重疊。

為什麼？我們來設想以下的情況。
比如說，如果今天有一個玩家的速度設定是**音符會提早兩拍出現**
所以，一個在99拍要被**打到**的音符，就會在**97拍**的時候出現在起點，並且花**兩拍**的時間從**起點**抵達**打擊線**
或者說，有另一個玩家的速度設定是**音符會提早四拍出現**
這樣的話，一個在99拍要被打到的音符，就會在95拍出現，並且花四拍的時間抵達終點線。自然，提早四拍出現的音符就會比提早兩拍的音符「慢」，即使他們抵達打擊線的拍子是一樣的。

也就是說，音符在軌道上的相對位置，等於`音符的打擊拍 - 現在實際的拍數 / 玩家設定的提早出現拍數`

現在，我們假設，在第98拍的時候，我們說「99拍要被打到的音符，用一拍的時間，把他的打擊拍加一拍（變成100）」，會發生什麼事呢？

音符會**暫停在軌道上**。

如果想不明白的話，我們做個思想實驗試試看。

玩家設定提早拍 = 2，100拍要被打到的音符。在第99拍的時候，用`a addbeat note 99 1 100-100 1 linear`

現在的拍數 | 音符在軌道上的位置 | 解說
------------ | ------------- | -------------
99 | `(100 - 98) / 2 = 1 (100%)` | 音符在軌道的起點
98.5 | `(100 - 98.5) / 2 = 0.75 (75%)` | 音符在軌道的1/4處
99 | `(100 - 99) / 2 = 0.5 (50%)` | 音符在軌道的1/2處，也就是中間。這個時候，`a addbeat note 99 1 100-100 1 linear`開始生效了
99.1 | `(100.1(<舞台行動給他加上的拍子) - 99.1) / 2 = 0.5 (50%)` | 為什麼這邊的音符拍數變成100.1了呢？因為這個時候舞台行動正在**花一拍給那個音符加上一拍**，現在正進行到**0.1拍的進度**，因此那個音符被加上了**0.1拍**，也就是100.1拍。**音符依然在軌道的一半位置，沒有移動**
99.5 | `100.5 - 99.5 / 2 = 0.5 (50%)` | 依然是一半的位置，依然沒有移動
100 | `101 - 100 / 2 = 0.5 (50%)` | 這個時候，舞台行動的效果已經結束了
100.1 | `101 - 100.1 / 2 = 0.48 (48%)` | 音符在軌道上48%的位置，更靠近打擊線了。音符重新開始移動。

這是一個很特殊的舞台行動，所以這裏特別講解一下
- 在這期間，音符依然可以被打到
- 如果這個行動本身開始的拍子被包含在影響範圍內，會導致無法被定義的情況，請不要這樣做
^開始拍為100，但是100被包含在影響的範圍，請不要這樣做
- 這個行動所影響的音符/舞台行動的開始拍會完全變動
```
//這裏有個102拍的短音符，我想要影響他兩次
n short rc 102
//這裡影響了一次，101拍的時候，上面這個音符的拍子已經變成105拍了（102+3)
a addbeat note/action 100 1 100-103 3 easeinoutsine
//這裏，我想再影響剛剛那個音符。所以我必須包含105拍，因為他的拍子已經不是102拍，而是105拍了
a addbeat note/action 102 1 105-106 3 easeinoutsine
```
- 這個行動沒辦法讓已經執行過的音符/舞台行動「死而復生」
  - 他們不會重新「再出現」。這個舞台行動只能影響他「之後的舞台行動」跟「他被執行時，已經在被執行而且還沒有結束的舞台行動」
- 如果你想要「倒退的效果」，「加上的拍子」應該要「小於」「執行的時間」
```
a addbeat note 99 1 100-104 2 easeInOutSine
```
花了一拍加上兩拍，這只會導致音符跟舞台行動執行的速度變慢
```
a addbeat note 99 1 100-104 1 easeInOutSine
```
花了一拍的時間加上了一拍，這會導致類似暫停的效果（但是不會比暫停數拍子的效果更好）
